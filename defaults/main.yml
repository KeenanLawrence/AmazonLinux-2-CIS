---
## COPYRIGHT NOTICE - LICENSED UNDER GNU GPLV3 ##
## START COPYRIGHT NOTICE ##
# AmazonLinux2-CIS Ansible Script - Under Joint Copyright
# Copyright (C) 2019  RADSec
# Copyright (C) 2019  Glownew Group

# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.

# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.

# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.
## END COPYRIGHT NOTICE ##
# defaults file for AmazonLinux2CIS

# Define what sections to run
amazonlinux2cis_notauto: false
amazonlinux2cis_section1: true
amazonlinux2cis_section2: true
amazonlinux2cis_section3: true
amazonlinux2cis_section4: true
amazonlinux2cis_section5: true
amazonlinux2cis_section6: true

############################
### Section 1 Parameters ###
############################

# Section AIDE #

# Section 1.3.1 | Ensure AIDE is installed and configured
amazonlinux2cis_config_aide: true

# Section 1.3.2 | Ensure filestystem integrity is regularly checked | AIDE cron settings
amazonlinux2cis_aide_cron:
  cron_user: root
  cron_file: /etc/crontab
  aide_job: '/usr/sbin/aide --check'
  aide_minute: 0
  aide_hour: 5
  aide_day: '*'
  aide_month: '*'
  aide_weekday: '*'

# SELinux Section #

# Section 1.6.1.2 & 1.6.1.3 | Ensure SELinux state is enforcing and configured
# true = SELinux is disabled | false = SELinux is enabled
amazonlinux2cis_selinux_disable: false
# Section 1.6.1.2 & 1.6.1.3 | SELinux policy
amazonlinux2cis_selinux_pol: targeted

# MOTD Section #

# Disable Amazon Linux update-motd script
# set to true to enable custom motd to be properly set
amazonlinux2cis_disable_auto_motd: true
# Section 1.7.1.1 | Ensure message of the day is configured properly
amazonlinux2cis_set_motd: true
# Warning Banner Content (issue, issue.net, motd)
amazonlinux2cis_warning_banner: |
    Authorized uses only. All activity may be monitored and reported.
# End Banner

# System package updates #

# Section 1.8 | Ensure updates of software repos and system packages are up-to-date | Run yum update
amazonlinux2cis_update: false

############################
### Section 2 Parameters ###
############################

# Service configuration booleans set true to keep service
amazonlinux2cis_cups_server: false
amazonlinux2cis_dhcp_server: false
amazonlinux2cis_ldap_server: false
amazonlinux2cis_telnet_server: false
amazonlinux2cis_nfs_server: false
amazonlinux2cis_rpc_server: false
amazonlinux2cis_ntalk_server: false
amazonlinux2cis_rsyncd_server: false
amazonlinux2cis_tftp_server: false
amazonlinux2cis_rsh_server: false
amazonlinux2cis_nis_server: false
amazonlinux2cis_snmp_server: false
amazonlinux2cis_squid_server: false
amazonlinux2cis_smb_server: false
amazonlinux2cis_dovecot_server: false
amazonlinux2cis_httpd_server: false
amazonlinux2cis_vsftpd_server: false
amazonlinux2cis_named_server: false
amazonlinux2cis_nfs_rpc_server: false
amazonlinux2cis_is_mail_server: false
amazonlinux2cis_bind: false
amazonlinux2cis_vsftpd: false
amazonlinux2cis_httpd: false
amazonlinux2cis_dovecot: false
amazonlinux2cis_samba: false
amazonlinux2cis_squid: false
amazonlinux2cis_net_snmp: false
amazonlinux2cis_allow_autofs: false

amazonlinux2cis_openldap_clients_required: false
amazonlinux2cis_telnet_required: false
amazonlinux2cis_talk_required: false
amazonlinux2cis_rsh_required: false
amazonlinux2cis_ypbind_required: false

# Section 2.1.11 | Ensure xinetd is not enabled
# xinetd required
amazonlinux2cis_xinetd_required: false

# Section 2.2.1.x | Time synchronization #
# Time Synchronization - Use chrony or ntp
amazonlinux2cis_time_synchronization: ntp

# Section 2.2.1.2 OR Section 2.2.1.3 | Ensure chrony or ntp is configured
amazonlinux2cis_time_synchronization_servers:
    - 0.pool.ntp.org
    - 1.pool.ntp.org
    - 2.pool.ntp.org
    - 3.pool.ntp.org

# Section 2.2.2 | Ensure X Window System is not installed
# Set to 'true' if X Windows is needed in your environment
amazonlinux2cis_xwindows_required: no

# Section 2.2.3 | Ensure avahi server is not enabled
amazonlinux2cis_avahi_server: false

############################
### Section 3 Parameters ###
############################

# Section 3.1.1 & 3.1.2 | Ensure IP forwarding is disabled and Ensure packet redirect sending is disabled
# These rules can only be configured on non-host and router configurations

# System network parameters (host only OR host and router)
# if host only = false OR host and router = true
amazonlinux2cis_is_router: false

# IPv6 required
amazonlinux2cis_ipv6_required: true

# Section 3.4.2 | Ensure /etc/hosts.allow is configured
amazonlinux2cis_host_allow:
    - "10.0.0.0/255.0.0.0"
    - "172.16.0.0/255.240.0.0"
    - "192.168.0.0/255.255.0.0"

# 3.4.3 | Ensure /etc/hosts.deny is configured
amazonlinux2cis_enable_hosts_deny: false

# Section 3.6.1 | Ensure iptables is installed
# Selection of firewall package to use below | default: iptables
amazonlinux2cis_firewall: iptables
# Section 3.6.2 | Ensure default deny firewall policy
amazonlinux2cis_firewall_default_deny_rule: false
# Section 3.6.3 | Ensure loopback traffic is configured
amazonlinux2cis_firewall_loopback_rule: true
# Section 3.6.4 | Ensure outbound and established connections are configured
amazonlinux2cis_firewall_outbound_rule: true

############################
### Section 4 Parameters ###
############################

# 4.1.2 - Enable auditd
amazonlinux2cis_enable_auditd: false

# System Accounting and Logging
# Set logging service to 'true'
amazonlinux2cis_log_server: false

# Enable system auditing | Select rsyslog or syslog_ng from the settings below #
# rsyslog settings are sections 4.2.1.x
# syslog_ng settings are sections 4.2.2.x

# Section 4.2.1.x | rsyslog settings
# IF using rsyslog, set to true and loghost_address should be reflected here
amazonlinux2cis_rsyslog: false
amazonlinux2cis_rsyslog_loghost_address: INSERT_DNS_NAME_HERE

# Section 4.2.2.x | syslog_ng settings
# IF using syslog_ng, set to true and loghost_address should be reflected here
amazonlinux2cis_syslog_ng: false
amazonlinux2cis_syslog_ng_loghost_address: INSERT_DNS_NAME_HERE

############################
### Section 5 Parameters ###
############################

# Section 5.4.4 | Ensure default user umask is 027 or more restrictive
amazonlinux2cis_modify_default_user_umask: true
amazonlinux2cis_default_user_umask: 027

############################
### Section 6 Parameters ###
############################

# Section 6.2.8 | Ensure users' home directory permissions are 750 or more restrictive
amazonlinux2cis_modify_user_homes: true
